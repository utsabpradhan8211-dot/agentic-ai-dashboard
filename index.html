<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Agentic AI Dashboard – Pharmaceutical R&D Intelligence</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: "Segoe UI", system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #0f172a, #1e293b);
      color: #f1f5f9;
      padding: 20px;
      min-height: 100vh;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    /* Header */
    .header {
      border-bottom: 2px solid #38bdf8;
      padding-bottom: 20px;
      margin-bottom: 30px;
    }

    .header h1 {
      font-size: 2.2rem;
      color: #38bdf8;
      margin-bottom: 8px;
    }

    .header p {
      color: #cbd5e1;
      font-size: 0.95rem;
    }

    /* KPI cards */
    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .metric-card {
      background: linear-gradient(135deg, #1e293b, #020617);
      border: 2px solid #38bdf8;
      border-radius: 12px;
      padding: 18px;
      text-align: center;
      transition: 0.25s;
      box-shadow: 0 10px 30px rgba(15, 23, 42, 0.8);
    }

    .metric-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 16px 40px rgba(56, 189, 248, 0.25);
    }

    .metric-value {
      font-size: 2.1rem;
      font-weight: 700;
      color: #38bdf8;
      margin-bottom: 6px;
    }

    .metric-label {
      text-transform: uppercase;
      font-size: 0.8rem;
      color: #94a3b8;
      margin-bottom: 8px;
      letter-spacing: 0.06em;
    }

    .metric-description {
      font-size: 0.85rem;
      color: #cbd5e1;
      line-height: 1.4;
    }

    /* Section titles */
    .section-title {
      font-size: 1.4rem;
      color: #38bdf8;
      margin-bottom: 18px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .section-title::before {
      content: "";
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #38bdf8;
    }

    /* Charts & cards */
    .charts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(360px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .chart-container,
    .table-container {
      background: linear-gradient(135deg, #1e293b, #020617);
      border-radius: 12px;
      border: 1px solid #334155;
      padding: 18px 20px;
      box-shadow: 0 12px 40px rgba(15, 23, 42, 0.85);
    }

    .chart-container h3,
    .table-container h3 {
      font-size: 1rem;
      margin-bottom: 12px;
      color: #e2e8f0;
    }

    .chart-wrapper {
      position: relative;
      height: 280px;
    }

    /* Table */
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.88rem;
    }

    th {
      text-align: left;
      padding: 10px 8px;
      background: #020617;
      color: #38bdf8;
      border-bottom: 1px solid #38bdf8;
      text-transform: uppercase;
      font-size: 0.75rem;
      letter-spacing: 0.04em;
    }

    td {
      padding: 9px 8px;
      border-bottom: 1px solid #1f2933;
      color: #cbd5e1;
    }

    tr.hoverable {
      cursor: pointer;
      transition: 0.18s;
    }

    tr.hoverable:hover {
      background: rgba(56, 189, 248, 0.06);
    }

    .rank-badge {
      display: inline-flex;
      width: 26px;
      height: 26px;
      border-radius: 999px;
      align-items: center;
      justify-content: center;
      background: #38bdf8;
      color: #020617;
      font-weight: 600;
      font-size: 0.8rem;
    }

    .status-pill {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.75rem;
      font-weight: 600;
      border: 1px solid transparent;
      min-width: 110px;
      text-align: center;
      transition: 0.18s;
    }

    .status-recommended {
      background: rgba(34, 197, 94, 0.15);
      color: #22c55e;
      border-color: #22c55e;
    }

    .status-not-recommended {
      background: rgba(248, 113, 113, 0.15);
      color: #f97373;
      border-color: #f97373;
    }

    .status-under-review {
      background: rgba(234, 179, 8, 0.18);
      color: #eab308;
      border-color: #eab308;
    }

    .status-priority {
      background: rgba(56, 189, 248, 0.15);
      color: #38bdf8;
      border-color: #38bdf8;
    }

    .status-monitor {
      background: rgba(129, 140, 248, 0.18);
      color: #818cf8;
      border-color: #818cf8;
    }

    .status-note {
      margin-top: 8px;
      font-size: 0.8rem;
      color: #94a3b8;
    }

    .legend {
      margin-top: 10px;
      font-size: 0.8rem;
      color: #94a3b8;
    }

    @media (max-width: 768px) {
      .chart-wrapper { height: 220px; }
      .header h1 { font-size: 1.6rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- HEADER -->
    <div class="header">
      <h1>Agentic AI Dashboard – Pharmaceutical R&amp;D Intelligence</h1>
      <p>Interactive prototype: click any medicine row to change its recommendation status.</p>
    </div>

    <!-- KPI CARDS -->
    <div class="metrics-grid">
      <div class="metric-card">
        <div class="metric-value">75%</div>
        <div class="metric-label">Time Reduction</div>
        <div class="metric-description">
          Drug repurposing: 8 months &#8594; 2 months.
        </div>
      </div>
      <div class="metric-card">
        <div class="metric-value">90%</div>
        <div class="metric-label">Accuracy Rate</div>
        <div class="metric-description">
          Validated regulatory and clinical evidence assessment.
        </div>
      </div>
      <div class="metric-card">
        <div class="metric-value">3×</div>
        <div class="metric-label">Throughput</div>
        <div class="metric-description">
          Parallel multi-agent processing across R&amp;D use cases.
        </div>
      </div>
      <div class="metric-card">
        <div class="metric-value">60%</div>
        <div class="metric-label">Cost Savings</div>
        <div class="metric-description">
          Reduced manual research and coordination overhead.
        </div>
      </div>
    </div>

    <!-- CHARTS: PROCESSING & PERFORMANCE -->
    <div class="section-title">Processing & Performance</div>
    <div class="charts-grid">
      <div class="chart-container">
        <h3>Drug Repurposing Timeline (Manual vs Agentic AI)</h3>
        <div class="chart-wrapper">
          <canvas id="timelineChart"></canvas>
        </div>
      </div>
      <div class="chart-container">
        <h3>Use Case Performance (Radar)</h3>
        <div class="chart-wrapper">
          <canvas id="radarChart"></canvas>
        </div>
      </div>
    </div>

    <!-- TABLE: DRUG OPPORTUNITIES -->
    <div class="section-title">Top 5 Drug Repurposing Opportunities</div>
    <div class="table-container">
      <h3>Click any row to cycle recommendation status</h3>
      <table id="drugsTable">
        <thead>
          <tr>
            <th>Rank</th>
            <th>Drug</th>
            <th>Target Indication</th>
            <th>Market Opportunity ($M)</th>
            <th>Regulatory Timeline</th>
            <th>Confidence</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="status-note">
        Status cycle on click: Recommended → Not Recommended → Under Review → Priority → Monitor → back to Recommended.
      </div>
    </div>

    <!-- AGENT-LEVEL CHARTS -->
    <div class="section-title">Agent Parallel Execution</div>
    <div class="charts-grid">
      <div class="chart-container">
        <h3>Agent Task Distribution</h3>
        <div class="chart-wrapper">
          <canvas id="agentChart"></canvas>
        </div>
      </div>
      <div class="chart-container">
        <h3>Processing Efficiency Across Workflow</h3>
        <div class="chart-wrapper">
          <canvas id="efficiencyChart"></canvas>
        </div>
      </div>
    </div>

    <div class="legend">
      All changes are handled through a Node.js API (Express) for demo purposes; data is stored in memory on the server.
    </div>
  </div>

  <script>
    // Status logic
    const STATUS_SEQUENCE = [
      "Recommended",
      "Not Recommended",
      "Under Review",
      "Priority",
      "Monitor"
    ];

    function statusClass(status) {
      switch (status) {
        case "Recommended":
          return "status-recommended";
        case "Not Recommended":
          return "status-not-recommended";
        case "Under Review":
          return "status-under-review";
        case "Priority":
          return "status-priority";
        case "Monitor":
          return "status-monitor";
        default:
          return "status-under-review";
      }
    }

    async function fetchDrugs() {
      const res = await fetch("/api/drugs");
      return res.json();
    }

    async function updateDrugStatus(id, status) {
      const res = await fetch(`/api/drugs/${id}/status`, {
        method: "PATCH",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ status })
      });
      return res.json();
    }

    function renderTable(drugs) {
      const tbody = document.querySelector("#drugsTable tbody");
      tbody.innerHTML = "";

      drugs.forEach((drug, idx) => {
        const tr = document.createElement("tr");
        tr.classList.add("hoverable");
        tr.dataset.id = drug.id;

        tr.innerHTML = `
          <td><span class="rank-badge">${idx + 1}</span></td>
          <td><strong>${drug.name}</strong></td>
          <td>${drug.indication}</td>
          <td>$${drug.marketOpportunity}M</td>
          <td>${drug.timeline}</td>
          <td>${drug.confidence}%</td>
          <td>
            <span class="status-pill ${statusClass(drug.status)}">${drug.status}</span>
          </td>
        `;

        tr.addEventListener("click", async () => {
          const currentStatus = drug.status;
          const currentIndex = STATUS_SEQUENCE.indexOf(currentStatus);
          const nextStatus =
            STATUS_SEQUENCE[(currentIndex + 1) % STATUS_SEQUENCE.length];

          const updated = await updateDrugStatus(drug.id, nextStatus);
          drug.status = updated.status;

          const pill = tr.querySelector(".status-pill");
          pill.textContent = updated.status;
          pill.className = "status-pill " + statusClass(updated.status);
        });

        tbody.appendChild(tr);
      });
    }

    // Charts
    function initCharts() {
      // Timeline chart
      const timelineCtx = document
        .getElementById("timelineChart")
        .getContext("2d");

      new Chart(timelineCtx, {
        type: "bar",
        data: {
          labels: ["Drug Repurposing", "Market Analysis", "Regulatory Prep"],
          datasets: [
            {
              label: "Traditional (weeks)",
              data: [32, 3, 4],
              backgroundColor: "rgba(148,163,184,0.45)",
              borderColor: "#94a3b8",
              borderWidth: 1,
              borderRadius: 6
            },
            {
              label: "Agentic AI (hours equiv.)",
              data: [2, 0.25, 0.5],
              backgroundColor: "rgba(56,189,248,0.8)",
              borderColor: "#38bdf8",
              borderWidth: 1,
              borderRadius: 6
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              labels: {
                color: "#cbd5e1",
                font: { size: 11 }
              }
            }
          },
          scales: {
            y: {
              ticks: { color: "#94a3b8" },
              grid: { color: "rgba(148,163,184,0.15)" }
            },
            x: {
              ticks: { color: "#94a3b8" },
              grid: { color: "rgba(148,163,184,0.08)" }
            }
          }
        }
      });

      // Radar chart
      const radarCtx = document
        .getElementById("radarChart")
        .getContext("2d");

      new Chart(radarCtx, {
        type: "radar",
        data: {
          labels: [
            "Speed",
            "Accuracy",
            "Throughput",
            "Compliance",
            "Cost Efficiency",
            "Scalability"
          ],
          datasets: [
            {
              label: "Traditional",
              data: [30, 75, 20, 60, 40, 35],
              borderColor: "#94a3b8",
              backgroundColor: "rgba(148,163,184,0.1)"
            },
            {
              label: "Agentic AI",
              data: [95, 90, 90, 95, 85, 95],
              borderColor: "#38bdf8",
              backgroundColor: "rgba(56,189,248,0.25)"
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              labels: {
                color: "#cbd5e1",
                font: { size: 11 }
              }
            }
          },
          scales: {
            r: {
              angleLines: { color: "rgba(148,163,184,0.3)" },
              grid: { color: "rgba(148,163,184,0.15)" },
              pointLabels: { color: "#cbd5e1" },
              ticks: { color: "#94a3b8" }
            }
          }
        }
      });

      // Agent distribution
      const agentCtx = document
        .getElementById("agentChart")
        .getContext("2d");

      new Chart(agentCtx, {
        type: "doughnut",
        data: {
          labels: [
            "Data Integration",
            "Analytics",
            "Validation",
            "Reporting",
            "Learning"
          ],
          datasets: [
            {
              data: [22, 28, 18, 20, 12],
              backgroundColor: [
                "rgba(56,189,248,0.85)",
                "rgba(34,197,94,0.85)",
                "rgba(168,85,247,0.85)",
                "rgba(234,179,8,0.85)",
                "rgba(239,68,68,0.85)"
              ],
              borderColor: "#020617",
              borderWidth: 2
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              labels: {
                color: "#cbd5e1",
                font: { size: 11 }
              }
            }
          }
        }
      });

      // Efficiency line chart
      const effCtx = document
        .getElementById("efficiencyChart")
        .getContext("2d");

      new Chart(effCtx, {
        type: "line",
        data: {
          labels: [
            "Reception",
            "Decomposition",
            "Data Gathering",
            "Analysis",
            "Validation",
            "Ranking",
            "Output"
          ],
          datasets: [
            {
              label: "Processing Efficiency (%)",
              data: [100, 95, 92, 94, 96, 98, 90],
              borderColor: "#38bdf8",
              backgroundColor: "rgba(56,189,248,0.18)",
              borderWidth: 2.5,
              fill: true,
              tension: 0.4,
              pointBackgroundColor: "#38bdf8",
              pointBorderColor: "#020617",
              pointRadius: 5
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              labels: {
                color: "#cbd5e1",
                font: { size: 11 }
              }
            }
          },
          scales: {
            y: {
              min: 0,
              max: 100,
              ticks: { color: "#94a3b8" },
              grid: { color: "rgba(148,163,184,0.15)" }
            },
            x: {
              ticks: { color: "#94a3b8" },
              grid: { color: "rgba(148,163,184,0.08)" }
            }
          }
        }
      });
    }

    // Initialise dashboard
    (async function init() {
      initCharts();
      const drugs = await fetchDrugs();
      renderTable(drugs);
    })();
  </script>
</body>
</html>
